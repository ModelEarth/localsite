<!DOCTYPE html>
<html lang="en-us">
<head>
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html;">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="shortcut icon" href="data:image/x-icon;," type="image/x-icon">

<title>LocalSite - Player</title>
<style>
body {
  margin: 0;
}
</style>
<script type="text/javascript" src="/localsite/js/jquery.min.js" id="/localsite/js/jquery.min.js"></script>
<script type="text/javascript" src="/localsite/js/localsite.js?showheader=true&showsearch=false&showfilters=false"></script>

</head>

<body>

<!-- Swiper and Plyr -->

<style>
.slideTextBox {
    text-align: left;
    position: absolute;
    left: 80px;
    top: 90px;
    background-color: rgba(250,250,256,.85);
    padding: 30px 20px 12px 30px;
    overflow: scroll;
    border-radius: 20px;
    max-height: 74%;
    max-width: 350px;
}
.slideText {
  position:absolute;
  color: #fff;
  font-size: 18px;
  background-color: rgba(33,33,33,0.6);
  border-radius: 30px;
  padding: 30px 40px 30px 40px;
}
.slideTextLeft {
  text-align: left;
  left: 80px;
  top: 90px;
}
.slideTextRight {
  text-align: left;
  border-radius: 0px;
  border-top-left-radius: 30px;
  right: 0px;
  bottom: 0px;
  z-index: 99999;
}
.swiper-slide .imgcrop { /* could also use: .swiper-slide img */
    opacity: 0.9;
    min-width: 100%;
    min-height: 100%;
    object-fit: cover;
}
/* Add an icon and script to add class .fullimage to swiper-slide to override .imgcrop above. */
.swiper-slide.fullimage {
    min-width: inherit;
    min-height: inherit;
    object-fit: none;
}

.swiper-slide-container {
  margin: 0px auto;
  width:100%;
  height:100%;
}

/* Move play button lower right */
/*
.swiper-button-play, .swiper-button-pause {
  background-position: right 0px bottom 10px !important;
}
.swiper-button-next {
  height: auto !important;
  bottom: 85px !important;
}
*/

</style>

<!--
Swiper responds to keyboard arrows and swipes on mobile.

Notes:
Width:100% currently has to be included on the a href tag to prevent margins if image width is exceeded.
Set the height:100% on div within swiper-slide
text-align:left; overflow:scroll; 
-->

<link rel="stylesheet" href="/localsite/css/swiper/swiper-bundle.min.css" />

<link rel='stylesheet' href='/localsite/css/swiper/plyr.css'>
<!-- 
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css">
-->
<link rel='stylesheet' href='/localsite/css/swiper/swiper.css'>

<script src='/localsite/js/polyfill.min.js?features=es6,Array.prototype.includes,CustomEvent,Object.entries,Object.values,URL'></script>
<script src='/localsite/js/plyr.min.js'></script>

  <!-- data-id="sample1" -->
  <!-- background: #000; background-color: #000; -->
  <div class="swiper-container" style="overflow:hidden;" id="sample1">

    <div class="swiper-wrapper">
      
      <!-- Slide 1 -->
      <!-- /localsite/img/hero/future-teepee.png -->
      <div class="swiper-slide" data-hash="explore">
        <img class="imgcrop" src="/localsite/img/hero/daisy.png">
        <!-- Oddly the loader icon appears when clicking back to the first slide 
          (when intended pause occurs), so we omit loading icon here. -->
        <!--<div class="swiper-lazy-preloader swiper-lazy-preloader-white"></div>-->
        <div class="slideText" style="top:48%">
          Welcome
        </div>
      </div>

      <!-- Slide 2 -->
      <div class="swiper-slide" data-hash="plant">
        <!-- Also leave off lazy on the second to avoid loading icon. -->
        <img class="imgcrop" src="/localsite/img/hero/plant.png" style="opacity:0.9;">
        <div class="swiper-lazy-preloader swiper-lazy-preloader-white"></div>
        <div class="slideText" style="position:absolute; bottom:-20px; right: 0px; z-index:999999999">
          Text in corner 1
        </div>
      </div>

      <!-- Slide 3 -->
      <div class="swiper-slide" fetchpriority="low" data-hash="2to1-ratio" style="position: relative;">
        <img class="imgcrop" loading="lazy" src="/localsite/img/hero/2to1-ratio.png" style="opacity:0.9;width:100%;max-width:2000px">
        <div class="swiper-lazy-preloader swiper-lazy-preloader-white"></div>
        <div class="slideText" style="position:absolute; bottom:-20px; right: 0px; z-index:999999999">
          Text in corner 2
        </div>
      </div>

      <!-- Slide 4 -->
      <div class="swiper-slide" fetchpriority="low" data-hash="sun">
        <!-- Example of smaller: solar-rect-sm.png -->
        <!--img class="swiper-lazy swiper-blur" src="/localsite/img/hero/solar-rect.png" style="width:100%;max-width:2000px;"-->
        <img class="imgcrop" loading="lazy" src="/localsite/img/hero/solar-rect.png">
        <div class="swiper-lazy-preloader swiper-lazy-preloader-white" style="position: relative; border: 10px solid red;"></div>
        <div class="slideText slideTextRight">
         Tall cropped image
        </div>
      </div>

      <!-- Slide 5: A Walkable Street -->
      <div class="swiper-slide" fetchpriority="low" data-hash="communities">
        <!--img class="swiper-lazy swiper-blur" src="/localsite/img/hero/sustainable-communities.jpg" style="width:100%;max-width:2000px;"-->
        <img class="imgcrop" loading="lazy" src="/localsite/img/hero/sustainable-communities.jpg" style="opacity:0.9;width:100%;max-width:3000px">
        <div class="swiper-lazy-preloader swiper-lazy-preloader-white"></div>
        <div class="slideText slideTextLeft"><!-- also a css class called .box in css/swiper/swiper.css -->

          <div class="title">Title</div>
          <!-- data-swiper-parallax="-200" -->
          <div class="subtitle">Subtitle</div>
          
        </div>
      </div>

      <!-- Slide 6: Video -->
      <div class="swiper-slide" data-hash="tilford-yard">
        <div class="swiper-slide-container">
          <div id="player1" data-plyr-provider="youtube" data-plyr-embed-id="oV2_YtrqgyQ"></div>
        </div>
        <script>
            player = new Plyr('#player1', {autopause:'true',hideControls:'true'});

            player.on('ended', function(event) {
                player.restart(); // To avoid seeimg menu of other videos.
                // player.play(); // infinite loop
            });

            /*
            // Probably swith to array of players
            players[0].on('ended', function(event) {
                players[0].restart();
                // players[0].play(); // infinite loop
            });
            */
            window.player = player;
        </script>
        <div class="slideTextBox">
          <div class="title">Tilford Yard</div>
          <div class="subtitle" data-swiper-parallax="-200"></div>
          <div class="text" data-swiper-parallax="-100">
            <p>Located northwest of Atlanta, Tilford Yard has been transformed in recent years as residential has expanded along the Beltline trail.<br><br>
            </p>
          </div>
        </div>
      </div>
      
    </div>
    <!--
    Not using noSwipingClass. Didn't work yet for limiting verticle scroll when mousewheel:true. Remove noSwipingClass.
    -->
  


    <!-- Swiper Nav -->
    <div class="swiper-button-prev swiper-button-prev-sample1 swiper-no-swiping noSwipingClass">
      <!--<div class="swiper-button-white"></div>-->
    </div>
    <!--
    <div class="swiper-button-play swiper-button-play-sample1"></div>
    <div class="swiper-button-pause swiper-button-pause-sample1"></div>
    -->

    <div class="swiper-button-next swiper-button-next-sample1 swiper-no-swiping noSwipingClass">
      <!--<div class="swiper-button-white"></div>-->
    </div>
    <!-- /Swiper Nav-->

  </div>

  <!-- Swiper Pagination -->
  <div style="clear:both"></div>
  <div style="width:94%"><!-- bug -->
    <div style="position:relative;float:right;">
      <div class="swiper-button-play swiper-button-play-lower swiper-button-play-sample1" style="display:none"></div>
      <div class="swiper-button-pause swiper-button-pause-lower swiper-button-pause-sample1" style="display:none"></div>
    </div>
    <div style="overflow: auto;">
      <div class="swiper-pagination swiper-pagination-sample1" style="margin-top:15px;"></div>
    </div>
  </div>
  <!-- /Swiper Pagination -->

  <!--
    To avoid 404 warning in inspector:
    Downloaded and renamed swiper.min.js.map to swiper-bundle.min.js.map
    Haven't yet confirmed that's the correct file to use, but reolved 404 error.
  -->
  <script src="/localsite/js/swiper/swiper-bundle.min.js"></script>
  
  <!--
  <script src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script>
-->


<!-- Initialize Swiper -->
<script>
// Init multiple slider on a single page
// https://stackoverflow.com/questions/32118999/how-can-i-have-multiple-swiper-slideshows-on-a-single-page
// Function that builds the swiper 
/*
        lazy: {
          loadPrevNext: true,
        },
*/
const buildSwiperSlider = sliderElm => {
    const sliderIdentifier = sliderElm.id;
    const homeSwiper = new Swiper(`#${sliderElm.id}`, {
        slidesPerView: 1,
        spaceBetween: 0,
        loop: true,
        speed: 800, /* transition 1400 */

        slidesPerView: 'auto',
        lazy: true,
        navigation: {
            nextEl: '.swiper-button-next-' + sliderIdentifier,
            prevEl: '.swiper-button-prev-' + sliderIdentifier
        },
        pagination: {
            el: '.swiper-pagination-' + sliderIdentifier,
            clickable: true,
        },
        
        effect: 'fade',
        mousewheelX: true, // Avoiding because also invokes verticle scroll on desktop.
        releaseOnEdgesX: true,

        /* change hash value (and load based on hash) -- problem: overwrites other hash values */
        /* also causes favicon to reload */

        
        hashNavigation: {
          watchState: true,
        },
        

        keyboard: {
          enabled: true,
          onlyInViewport: false
        },
        directionX: 'horizontal',
        /*
        history: {
          keepQuery: true
        },

        // Could see if any of these are supported by Slider 10.0
        watchSlidesProgress: true, // enable the 'proress' property on each slide
        virtualTranslate: true, // makes the slider not move automatically, you'll have to do the translate animation
        watchSlidesVisibility: true, // slides that in viewport will have additional visible class
        effect: "myCustomTransition", // optional - set the name of your animation. You can later check if your animation is actually applied and abort animation if not.

        */
    });

    $(".swiper-button-pause-" + sliderIdentifier).click(function(){
      $(".swiper-button-pause-" + sliderIdentifier).hide();
      $(".swiper-button-play-" + sliderIdentifier).show();
      $(".swiper-button-pause-" + sliderIdentifier).addClass("overrideShowPauseQuick");
      homeSwiper.autoplay.stop(); // Tiggers icon change below at autoplayStop event
    });

    $(".swiper-button-play-" + sliderIdentifier).click(function(){
      homeSwiper.slideNext(); // Immidiately advance to next on click.
      $(".swiper-button-play-" + sliderIdentifier).hide();
      $(".swiper-button-pause-" + sliderIdentifier).show();
      homeSwiper.autoplay.start();
    });

    $(".swiper-pagination-" + sliderIdentifier + " .swiper-pagination-bullet").click(function(){
      $(".swiper-button-pause-" + sliderIdentifier).hide();
      $(".swiper-button-play-" + sliderIdentifier).show();
    });
    $(".swiper-button-prev-" + sliderIdentifier).click(function(){
      $(".swiper-button-pause-" + sliderIdentifier).hide();
      $(".swiper-button-play-" + sliderIdentifier).show();
    });
    $(".swiper-button-next-" + sliderIdentifier).click(function(){
      $(".swiper-button-pause-" + sliderIdentifier).hide();
      $(".swiper-button-play-" + sliderIdentifier).show();
    });
    homeSwiper.on('autoplayStart', function () {
      //$(".swiper-pagination-bullet-active").css("background","green");
      $('head').append('<style id="customCSS">.swiper-pagination-bullet-active { background:green !important }</style>');
    });
    // Triggered by keyboard arrow keys and pause button:
    homeSwiper.on('autoplayStop', function () {
      //$(".swiper-pagination-bullet-active").css("background","#888");
      $('#customCSS').remove();
      // Briefly show the pause button
      $(".swiper-button-pause-" + sliderIdentifier).show();
      $(".swiper-button-pause-" + sliderIdentifier).addClass("showPauseQuick");
      //alert("stop")
      setTimeout(() => {
        $(".swiper-button-pause-" + sliderIdentifier).hide();
        $(".swiper-button-pause-" + sliderIdentifier).removeClass("showPauseQuick"); // to do: figure out why not fading
        $(".swiper-button-pause-" + sliderIdentifier).removeClass("overrideShowPauseQuick"); // Allows pause not to be retained briefly when clicking actual pause button.
      },1000);
      $(".swiper-button-play-" + sliderIdentifier).show();
    });

    // Play on iniital load
    $(".swiper-button-play-" + sliderIdentifier).hide();
    $(".swiper-button-pause-" + sliderIdentifier).show();
    homeSwiper.autoplay.start();

    //return homeSwiper;
}

// Get all of the swipers on the page
const allSliders = document.querySelectorAll('.swiper-container');

// Loop over all of the fetched sliders and apply Swiper on each one.
allSliders.forEach(slider => buildSwiperSlider(slider));

$(".swiper-button-play").show();
//$(".swiper-button-play").css('opacity', '0.8');



let initIDX = 0;
if(window.location.hash){
    let lmnt = document.querySelector('[data-hash="'+window.location.hash.substring(1)+'"]'),
    i = 0;

    while((lmnt = lmnt.previousSibling) != null) if(lmnt.nodeType == 1) ++i;

    initIDX = i;
}

var vis = document.getElementById('vis'),
    swiperOpts = {
        loop: true,
        slidesPerView: 1,
        initialSlide: initIDX,
        on:{
            slideChangeTransitionEnd: function(){
                history.replaceState(null, null,
                    window.location.pathname + '#' + this.slides[this.activeIndex].dataset.hash);
            }
        }
    },
    swiper = new Swiper(vis, swiperOpts);




</script>
<!-- /Initialize Swiper -->

<!-- /Swiper and Plyr -->


<div class="content contentpadding" style="padding-top: 0px">

  <div style="float:right">
    <!--
    <a href="https://github.com/localsite/planning/blob/main/schema.prisma">Real World 2.0 Data Structure</a> - Common tables for civic tech apps 
    -->
    <!--
    <a href="https://nextjs.org">NextJS</a>, <a href="https://www.prisma.io">Prisma</a> and <a href="https://blitzjs.com">BlitzJS</a><br><br>
    -->
  </div>

  <h1 style="padding-top: 0px">Localsite Framework</h1>

  <!--
    Swiper demos:
    https://swiperjs.com/demos

    Also parallax:
    https://codesandbox.io/s/empty-feather-sqgrj?file=/src/App.js
  -->
  Localsite uses <a href="https://swiperjs.com/">SwiperJS</a> with Leaflet Maps and the MapBox <a href="https://docs.mapbox.com/mapbox-gl-js/style-spec/layers/">Layers JSON Format</a> to manage map layers in the map.js styleObject.  

  <section id="parameters">
    <div id="paramsDiv" style="clear:both"></div>
  </section>
  
	<div class="two pageColumns">
	    <div class="pageColumn">
	      <div class="pageColumnInside">
	          <div id="readmeDiv"></div>
	      </div>
	    </div>
	    <div class="pageColumn">
	      <div class="pageColumnInside">
	        <div id="featuresDiv"></div>
	      </div>
	    </div>
	</div>
  

  <h2 style="clear:both">Browser LocalStorage</h2>
  The following values reside in your browser's localStorage for persistance across site visits:<br><br>

  <div id="displayStorage"></div>
  <script>
  // View localStorage values
  for(var i=0, len=localStorage.length; i<len; i++) {
      var key = localStorage.key(i);
      var value = localStorage[key];
      if (value.indexOf("<svg") > 0) {
        $("#displayStorage").append("<b>" + key + ":</b> [svg]<br><br>");
      } else {
        $("#displayStorage").append("<b>" + key + ":</b> " + value + "<br><br>");
      }
  }
  </script>

</div>

<script>
    loadMarkdown("README.md", "readmeDiv", "_parent");
    loadMarkdown("start/features.md", "featuresDiv", "_parent");
    loadMarkdown("start/params.md", "paramsDiv", "_parent");
</script>

<img loading="lazy" fetchpriority="low" src="/localsite/img/hero/stars.jpg" style="width:100%">

<div id="footer"></div>

</body>
</html>