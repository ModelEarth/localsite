<!DOCTYPE html>
<html lang="en-us">
<head>
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html;">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="shortcut icon" href="data:image/x-icon;," type="image/x-icon">
<title>LocalSite Parameters</title>

<script>
//if(typeof param=='undefined'){ var param={}; }
//param.showsearch = "true";
//param.display = "everything"
//param.geoview = "state"
//param.state = "NY"
//param.indicators = "GHG,GCC,MGHG,OGHG,HRSP,OZON,SMOG,HAPS,ENRG,WATR"
</script>

<style>
body {
  margin: 0;
}
</style>

<!-- javascript included early for use by swiper -->
<script type="text/javascript" src="/localsite/js/jquery.min.js" id="/localsite/js/jquery.min.js"></script>

<script type="text/javascript" src="/localsite/js/localsite.js?showheader=true&showsearch=true"></script>

</head>

<body>

<!-- Swiper and Plyr -->

<style>
.slideTextBox {
  text-align: left;
  position: absolute;
  left: 80px;
  top: 90px;
  background-color: rgba(250,250,256,.85);
  padding: 30px 20px 12px 30px;
  overflow: scroll;
  border-radius: 20px;
  max-height: 74%;
  max-width: 350px;
}
.dark .slideTextBox {
  color: #333;
}
.slideText {
  position:absolute;
  color: #fff;
  font-size: 18px;
  background-color: rgba(33,33,33,0.6);
  border-radius: 30px;
  padding: 30px 40px 30px 40px;
}
.slideTextLeft {
  text-align: left;
  left: 80px;
  top: 90px;
}
.slideTextRight {
  text-align: left;
  border-radius: 0px;
  border-top-left-radius: 30px;
  border-bottom-left-radius: 30px;
  right: 0px;
  bottom: 0px;
  z-index: 99999;
}
.swiper-slide .imgcrop { /* could also use: .swiper-slide img */
    opacity: 0.9;
    min-width: 100%;
    min-height: 100%;
    object-fit: cover;
}
/* Add an icon and script to add class .fullimage to swiper-slide to override .imgcrop above. */
.swiper-slide.fullimage {
    min-width: inherit;
    min-height: inherit;
    object-fit: none;
}

.swiper-slide-container {
  margin: 0px auto;
  width:100%;
  height:100%;
}
.swiper-slide-container iframe {
  object-fit: cover;
}
/* Move play button lower right */
/*
.swiper-button-play, .swiper-button-pause {
  background-position: right 0px bottom 10px !important;
}
.swiper-button-next {
  height: auto !important;
  bottom: 85px !important;
}
*/
.plyr {
  height: 100%;
  margin-top: -4px;
}
.chart-wrapper {
  width: 100%;
  max-width: 100%;
  overflow-x: auto;
  padding: 10px 0;
  height: 300px; 
}

@media (max-width: 768px) {
  .chart-wrapper {
    height: 260px;; /* taller for narrow screens */
  }
  select {
  padding: 8px 12px;
  font-size: 16px;
  border-radius: 8px;
  border: 1px solid #ccc;
  background-color: #fff;
  max-width: 100%;
  box-sizing: border-box;
}
  #chartVariable,
  #entityId,
  .whichLinesHolder,
  #perCapitaOptions {
    display: block;
    width: 100%;
    margin-bottom: 10px;
  }

  label input[type="radio"] {
    margin-right: 5px;
  }

  .chart-controls {
    display:flex;
    flex-direction: column;
    gap: 10px;
  }
  canvas {
    width: 100% !important;
    height: 100% !important; /* Keeps it scaling inside wrapper */
  }
}
</style>

<!--
Swiper responds to keyboard arrows and swipes on mobile.

Notes:
Width:100% currently has to be included on the a href tag to prevent margins if image width is exceeded.
Set the height:100% on div within swiper-slide
text-align:left; overflow:scroll; 
-->

<link rel="stylesheet" href="/localsite/css/swiper/swiper-bundle.min.css" />

<link rel='stylesheet' href='/localsite/css/swiper/plyr.css'>
<!-- 
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css">
-->
<link rel='stylesheet' href='/localsite/css/swiper/swiper.css'>

<script src='/localsite/js/polyfill.min.js?features=es6,Array.prototype.includes,CustomEvent,Object.entries,Object.values,URL'></script>
<script src='/localsite/js/plyr.min.js'></script>

  <!-- data-id="sample1" -->
  <!-- background: #000; background-color: #000; -->
  <div class="swiper-container" style="overflow:hidden;" id="sample1">

    <div class="swiper-wrapper">
      
      <!-- Slide 1 -->
      <!-- /localsite/img/hero/future-teepee.png -->
      <div class="swiper-slide" data-hash="explore">
        <img class="imgcrop" src="/localsite/img/hero/daisy.png">
        <!-- Oddly the loader icon appears when clicking back to the first slide 
          (when intended pause occurs), so we omit loading icon here. -->
        <!--<div class="swiper-lazy-preloader swiper-lazy-preloader-white"></div>-->
        <div class="slideText" style="top:48%">
          <b>Edit Localsite Parameters</b><br>
          Scroll down to view localsite parameters that you can add to your HTML pages.
        </div>
      </div>

      <!-- Slide 2 -->
      <div class="swiper-slide" data-hash="plant">
        <!-- Also leave off lazy on the second to avoid loading icon. -->
        <img class="imgcrop" src="/localsite/img/hero/plant.png" style="opacity:0.9;">
        <div class="swiper-lazy-preloader swiper-lazy-preloader-white"></div>
        <div class="slideText" style="position:absolute; bottom:-20px; right: 0px; z-index:999999999">
          Copy our starter index.html.
        </div>
      </div>

      <!-- Slide 3 -->
      <div class="swiper-slide" fetchpriority="low" data-hash="2to1-ratio" style="position: relative;">
        <img class="imgcrop" loading="lazy" src="/localsite/img/hero/2to1-ratio.png" style="opacity:0.9;width:100%;max-width:2000px">
        <div class="swiper-lazy-preloader swiper-lazy-preloader-white"></div>
        <div class="slideText" style="position:absolute; bottom:-20px; right: 0px; z-index:999999999">
          Add your parameters
        </div>
      </div>

      <!-- Slide 4 -->
      <div class="swiper-slide" fetchpriority="low" data-hash="sun">
        <!-- Example of smaller: solar-rect-sm.png -->
        <!--img class="swiper-lazy swiper-blur" src="/localsite/img/hero/solar-rect.png" style="width:100%;max-width:2000px;"-->
        <img class="imgcrop" loading="lazy" src="/localsite/img/hero/solar-rect.png">
        <div class="swiper-lazy-preloader swiper-lazy-preloader-white" style="position: relative; border: 10px solid red;"></div>
        <div class="slideText slideTextRight">
         Tall cropped image example
        </div>
      </div>

      <!-- Slide 5: A Walkable Street -->
      <div class="swiper-slide" fetchpriority="low" data-hash="communities">
        <!--img class="swiper-lazy swiper-blur" src="/localsite/img/hero/sustainable-communities.jpg" style="width:100%;max-width:2000px;"-->
        <img class="imgcrop" loading="lazy" src="/localsite/img/hero/sustainable-communities.jpg" style="opacity:0.9;width:100%;max-width:3000px">
        <div class="swiper-lazy-preloader swiper-lazy-preloader-white"></div>
        <div class="slideText slideTextLeft"><!-- also a css class called .box in css/swiper/swiper.css -->

          <div class="title">Title</div>
          <!-- data-swiper-parallax="-200" -->
          <div class="subtitle">Subtitle</div>
          
        </div>
      </div>

      <!-- Slide 6: Video -->
      <div class="swiper-slide" data-hash="tilford-yard">
        <div class="swiper-slide-container">
          <div id="player1" data-plyr-provider="youtube" data-plyr-embed-id="oV2_YtrqgyQ"></div>
        </div>
        <script>
            player = new Plyr('#player1', {autopause:'true',hideControls:'true'});

            player.on('ended', function(event) {
                player.restart(); // To avoid seeimg menu of other videos.
                // player.play(); // infinite loop
            });

            /*
            // Probably swith to array of players
            players[0].on('ended', function(event) {
                players[0].restart();
                // players[0].play(); // infinite loop
            });
            */
            window.player = player;
        </script>
        <div class="slideTextBox">
          <div class="title">Tilford Yard</div>
          <div class="subtitle" data-swiper-parallax="-200"></div>
          <div class="text" data-swiper-parallax="-100">
            <p>Located northwest of Atlanta, Tilford Yard has&nbsp;been transformed by new residential construction along the Beltline trail.<br><br>
            </p>
          </div>
        </div>
      </div>
      
    </div>
    <!--
    Not using noSwipingClass. Didn't work yet for limiting verticle scroll when mousewheel:true. Remove noSwipingClass.
    -->
  


    <!-- Swiper Nav -->
    <div class="swiper-button-prev swiper-button-prev-sample1 swiper-no-swiping noSwipingClass">
      <!--<div class="swiper-button-white"></div>-->
    </div>
    <!--
    <div class="swiper-button-play swiper-button-play-sample1"></div>
    <div class="swiper-button-pause swiper-button-pause-sample1"></div>
    -->

    <div class="swiper-button-next swiper-button-next-sample1 swiper-no-swiping noSwipingClass">
      <!--<div class="swiper-button-white"></div>-->
    </div>
    <!-- /Swiper Nav-->

  </div>

  <!-- Swiper Pagination -->
  <div style="width:94%"><!-- bug -->
    <div style="position:relative;float:right;">
      <div class="swiper-button-play swiper-button-play-lower swiper-button-play-sample1" style="display:none"></div>
      <div class="swiper-button-pause swiper-button-pause-lower swiper-button-pause-sample1" style="display:none"></div>
    </div>
    <div style="overflow: auto;">
      <div class="swiper-pagination swiper-pagination-sample1" style="margin-top:15px;"></div>
    </div>
  </div>
  <!-- /Swiper Pagination -->

  <!--
    To avoid 404 warning in inspector:
    Downloaded and renamed swiper.min.js.map to swiper-bundle.min.js.map
    Haven't yet confirmed that's the correct file to use, but reolved 404 error.
  -->
  <script src="/localsite/js/swiper/swiper-bundle.min.js"></script>
  
  <!--
  <script src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script>
-->


<!-- Initialize Swiper -->
<script>
// Init multiple slider on a single page
// https://stackoverflow.com/questions/32118999/how-can-i-have-multiple-swiper-slideshows-on-a-single-page
// Function that builds the swiper 
/*
        lazy: {
          loadPrevNext: true,
        },
*/
const buildSwiperSlider = sliderElm => {
    const sliderIdentifier = sliderElm.id;
    const homeSwiper = new Swiper(`#${sliderElm.id}`, {
        slidesPerView: 1,
        spaceBetween: 0,
        loop: true,
        speed: 800, /* transition 1400 */

        slidesPerView: 'auto',
        lazy: true,
        navigation: {
            nextEl: '.swiper-button-next-' + sliderIdentifier,
            prevEl: '.swiper-button-prev-' + sliderIdentifier
        },
        pagination: {
            el: '.swiper-pagination-' + sliderIdentifier,
            clickable: true,
        },
        
        effect: 'fade',
        mousewheelX: true, // Avoiding because also invokes verticle scroll on desktop.
        releaseOnEdgesX: true,

        /* Change hash value as images changes (and load based on hash) */
        /*
        BIG PROBLEM: overwrites other hash values, immediatly close upperright navigation. */
        /* also causes favicon to reload */
        /*
        hashNavigation: {
          watchState: true,
        },
        */

        keyboard: {
          enabled: true,
          onlyInViewport: false
        },
        directionX: 'horizontal',
        /*
        history: {
          keepQuery: true
        },

        // Could see if any of these are supported by Slider 10.0
        watchSlidesProgress: true, // enable the 'proress' property on each slide
        virtualTranslate: true, // makes the slider not move automatically, you'll have to do the translate animation
        watchSlidesVisibility: true, // slides that in viewport will have additional visible class
        effect: "myCustomTransition", // optional - set the name of your animation. You can later check if your animation is actually applied and abort animation if not.

        */
    });

    $(".swiper-button-pause-" + sliderIdentifier).click(function(){
      $(".swiper-button-pause-" + sliderIdentifier).hide();
      $(".swiper-button-play-" + sliderIdentifier).show();
      $(".swiper-button-pause-" + sliderIdentifier).addClass("overrideShowPauseQuick");
      homeSwiper.autoplay.stop(); // Tiggers icon change below at autoplayStop event
    });

    $(".swiper-button-play-" + sliderIdentifier).click(function(){
      homeSwiper.slideNext(); // Immidiately advance to next on click.
      $(".swiper-button-play-" + sliderIdentifier).hide();
      $(".swiper-button-pause-" + sliderIdentifier).show();
      homeSwiper.autoplay.start();
    });

    $(".swiper-pagination-" + sliderIdentifier + " .swiper-pagination-bullet").click(function(){
      $(".swiper-button-pause-" + sliderIdentifier).hide();
      $(".swiper-button-play-" + sliderIdentifier).show();
    });
    $(".swiper-button-prev-" + sliderIdentifier).click(function(){
      $(".swiper-button-pause-" + sliderIdentifier).hide();
      $(".swiper-button-play-" + sliderIdentifier).show();
    });
    $(".swiper-button-next-" + sliderIdentifier).click(function(){
      $(".swiper-button-pause-" + sliderIdentifier).hide();
      $(".swiper-button-play-" + sliderIdentifier).show();
    });
    homeSwiper.on('autoplayStart', function () {
      //$(".swiper-pagination-bullet-active").css("background","green");
      $('head').append('<style id="customCSS">.swiper-pagination-bullet-active { background:green !important }</style>');
    });
    // Triggered by keyboard arrow keys and pause button:
    homeSwiper.on('autoplayStop', function () {
      //$(".swiper-pagination-bullet-active").css("background","#888");
      $('#customCSS').remove();
      // Briefly show the pause button
      $(".swiper-button-pause-" + sliderIdentifier).show();
      $(".swiper-button-pause-" + sliderIdentifier).addClass("showPauseQuick");
      //alert("stop")
      setTimeout(() => {
        $(".swiper-button-pause-" + sliderIdentifier).hide();
        $(".swiper-button-pause-" + sliderIdentifier).removeClass("showPauseQuick"); // to do: figure out why not fading
        $(".swiper-button-pause-" + sliderIdentifier).removeClass("overrideShowPauseQuick"); // Allows pause not to be retained briefly when clicking actual pause button.
      },1000);
      $(".swiper-button-play-" + sliderIdentifier).show();
    });

    // Play on iniital load
    $(".swiper-button-play-" + sliderIdentifier).hide();
    $(".swiper-button-pause-" + sliderIdentifier).show();
    homeSwiper.autoplay.start();

    //return homeSwiper;
}

// Get all of the swipers on the page
const allSliders = document.querySelectorAll('.swiper-container');

// Loop over all of the fetched sliders and apply Swiper on each one.
allSliders.forEach(slider => buildSwiperSlider(slider));

//$(".swiper-button-play").show();
//$(".swiper-button-play").css('opacity', '0.8');


function setSwiperOpts() {
  let hash = getHash();
  let initIDX = 0;
  // TO DO: Reactivate if hash is again sent when slide changes.  Or store in browser cache.
  if(1==2 && hash){
      let lmnt = document.querySelector('[data-hash="'+window.location.hash.substring(1)+'"]'),
      i = 0;

      while((lmnt = lmnt.previousSibling) != null) if(lmnt.nodeType == 1) ++i;

      initIDX = i;
  }

  var vis = document.getElementById('vis'),
    swiperOpts = {
        loop: true,
        slidesPerView: 1,
        initialSlide: initIDX,
        on:{
            slideChangeTransitionEnd: function(){
                history.replaceState(null, null,
                    window.location.pathname + '#' + this.slides[this.activeIndex].dataset.hash);
            }
        }
    },
    swiper = new Swiper(vis, swiperOpts);
}
setSwiperOpts();

</script>
<!-- /Initialize Swiper -->

<!-- /Swiper and Plyr -->

<style>
  #readmeDiv H1{
  display: none;
}
.pageColumnStyle H1, .pageColumnStyle H2 {
  font-family: Raleway, Lato, "Helvetica Neue", Helvetica, "Lato", sans-serif;
  font-weight: 1000 !important;
  margin-top: 0px;
  font-size: 1.4em;
  padding-top: 12px;
  padding-bottom: 5px !important;
  border-bottom: 1px solid #ddd;
  color: rgb(77, 82, 89);
  color: #333;
  line-height: 1.55;
}
</style>

<div class="pageColumnStyle content contentpadding" style="padding-top: 0px">

  <div style="float:right">
    <!--
    <a href="https://github.com/localsite/planning/blob/main/schema.prisma">Real World 2.0 Data Structure</a> - Common tables for civic tech apps 
    -->
    <!--
    <a href="https://nextjs.org">NextJS</a>, <a href="https://www.prisma.io">Prisma</a> and <a href="https://blitzjs.com">BlitzJS</a><br><br>
    -->
  </div>

  <h1 style="padding-top: 0px">Localsite Parameters</h1>

  <!--
    Swiper demos:
    https://swiperjs.com/demos

    Also parallax:
    https://codesandbox.io/s/empty-feather-sqgrj?file=/src/App.js
  -->
  Localsite uses <a href="https://swiperjs.com/">SwiperJS</a> with Leaflet Maps and the MapBox <a href="https://docs.mapbox.com/mapbox-gl-js/style-spec/layers/">Layers JSON Format</a> to manage map layers in the map.js styleObject.  

  <section id="parameters">
    <div id="paramsDiv" style="clear:both"></div>
  </section>
  
	<div class="two pageColumns">
	    <div class="pageColumn">
	      <div class="pageColumnInside">
	          <div id="readmeDiv"></div>
	      </div>
	    </div>
	    <div class="pageColumn">
	      <div class="pageColumnInside">
	        <div id="featuresDiv"></div>
	      </div>
	    </div>
	</div>
  

  <style>
  #cacheViewerSection { container-type: inline-size; clear: both; }
  .cache-header-row {
    display: flex; align-items: center; justify-content: space-between;
    flex-wrap: wrap; gap: 8px; margin-bottom: 10px; clear: both;
  }
  .cache-header-row h2 { margin: 0; }
  .cache-tabs {
    display: flex; gap: 3px;
    background: #ebebeb; padding: 3px; border-radius: 9px;
  }
  .dark .cache-tabs { background: #2a2a2a; }
  .cache-tab {
    padding: 5px 16px; border-radius: 7px; border: none; cursor: pointer;
    font-size: 13px; font-weight: 500; background: transparent; color: #666;
    transition: all 0.14s ease; font-family: inherit;
  }
  .cache-tab.active { background: #fff; color: #222; box-shadow: 0 1px 4px rgba(0,0,0,0.13); }
  .dark .cache-tab { color: #999; }
  .dark .cache-tab.active { background: #3a3a3a; color: #eee; box-shadow: 0 1px 4px rgba(0,0,0,0.4); }
  .cache-controls {
    display: flex; gap: 8px; flex-wrap: wrap; align-items: center; margin-bottom: 10px;
  }
  .cache-search-wrap { position: relative; flex: 1; min-width: 140px; }
  .cache-search-wrap .material-icons {
    position: absolute; left: 9px; top: 50%; transform: translateY(-50%);
    font-size: 16px; color: #bbb; pointer-events: none;
  }
  .cache-search-box {
    width: 100%; box-sizing: border-box;
    padding: 7px 10px 7px 32px;
    border: 1px solid #ddd; border-radius: 8px;
    font-size: 13px; background: #fff; outline: none;
    transition: border-color 0.14s; font-family: inherit;
  }
  .cache-search-box:focus { border-color: #aaa; }
  .dark .cache-search-box { background: #222; border-color: #444; color: #eee; }
  .cache-select {
    padding: 7px 10px; border: 1px solid #ddd; border-radius: 8px;
    font-size: 13px; background: #fff; cursor: pointer; outline: none; font-family: inherit;
  }
  .dark .cache-select { background: #222; border-color: #444; color: #eee; }
  .cache-stats { font-size: 12px; color: #999; margin-bottom: 8px; }
  .cache-shortlist {
    display: none; flex-direction: row; align-items: center; gap: 10px;
    background: #f4f6fb; border-radius: 10px;
    padding: 8px 14px; margin-bottom: 12px;
  }
  .cache-shortlist.has-items { display: flex; }
  .dark .cache-shortlist { background: #1e2230; }
  .cache-shortlist-title {
    font-size: 11px; font-weight: 700; color: #999; text-transform: uppercase;
    letter-spacing: 0.06em; flex-shrink: 0; margin-left: auto; padding: 3px 9px;
    border-radius: 20px; cursor: pointer; border: 1px solid transparent; transition: all 0.14s;
  }
  .cache-shortlist-title:hover { background: #e8eef8; color: #1a5fd6; }
  .cache-shortlist-title.active { background: #1a5fd6; color: #fff; border-color: #1a5fd6; }
  .dark .cache-shortlist-title:hover { background: #1a2f5a; color: #7caff8; }
  .dark .cache-shortlist-title.active { background: #1a5fd6; color: #fff; }
  .cache-shortlist-tags { display: flex; flex-wrap: wrap; gap: 6px; flex: 1; }
  .cache-shortlist-tag {
    display: flex; align-items: center; gap: 4px;
    padding: 3px 10px; background: #dde8fb; color: #1a5fd6;
    border-radius: 20px; font-size: 12px; cursor: pointer; transition: all 0.14s;
  }
  .cache-shortlist-tag:hover { background: #c8dafc; }
  .cache-shortlist-tag.active { background: #1a5fd6; color: #fff; }
  .cache-shortlist-tag.active .sl-remove { color: #fff; }
  .dark .cache-shortlist-tag { background: #1a2f5a; color: #7caff8; }
  .dark .cache-shortlist-tag:hover { background: #22396e; }
  .dark .cache-shortlist-tag.active { background: #1a5fd6; color: #fff; }
  .cache-shortlist-tag .sl-remove {
    cursor: pointer; font-size: 15px; line-height: 1; opacity: 0.6;
    margin-left: 2px; transition: opacity 0.1s;
  }
  .cache-shortlist-tag .sl-remove:hover { opacity: 1; }
  .cache-param-list { display: flex; flex-direction: column; gap: 5px; }
  .cache-param-item {
    display: flex; align-items: center; gap: 10px;
    background: #fff; border: 1px solid #eee; border-radius: 10px;
    padding: 9px 12px; position: relative;
    transition: box-shadow 0.14s, border-color 0.14s;
  }
  .cache-param-item:hover { box-shadow: 0 2px 10px rgba(0,0,0,0.08); }
  .dark .cache-param-item { background: #1a1a1a; border-color: #2e2e2e; }
  .dark .cache-param-item:hover { box-shadow: 0 2px 10px rgba(0,0,0,0.35); }
  .cache-param-item.is-pinned { border-left: 3px solid #f5a623; }
  .cache-param-item.in-shortlist { border-left: 3px solid #1a73e8; }
  .cache-param-key {
    font-weight: 600; font-size: 13px; color: #333;
    min-width: 80px; word-break: break-all; flex-shrink: 0;
  }
  .dark .cache-param-key { color: #ddd; }
  .cache-param-value {
    flex: 1; font-size: 12px; color: #777; overflow: hidden;
    text-overflow: ellipsis; white-space: nowrap; font-family: monospace;
  }
  .dark .cache-param-value { color: #999; }
  .cache-param-type {
    font-size: 10px; padding: 2px 7px; border-radius: 10px;
    font-weight: 700; text-transform: uppercase; letter-spacing: 0.04em; flex-shrink: 0;
  }
  .cpt-json  { background: #e8f5e9; color: #2e7d32; }
  .cpt-svg   { background: #fce4ec; color: #b71c1c; }
  .cpt-string{ background: #e3f2fd; color: #1565c0; }
  .cpt-number{ background: #fff3e0; color: #e65100; }
  .cpt-empty { background: #f5f5f5; color: #9e9e9e; }
  .dark .cpt-json  { background: #1a3320; color: #81c784; }
  .dark .cpt-svg   { background: #3a1820; color: #ef9a9a; }
  .dark .cpt-string{ background: #1a2a3a; color: #90caf9; }
  .dark .cpt-number{ background: #3a2810; color: #ffcc80; }
  .dark .cpt-empty { background: #252525; color: #757575; }
  .cache-pin-icon { font-size: 13px !important; color: #f5a623; flex-shrink: 0; }
  .cache-menu-btn {
    background: none; border: none; cursor: pointer; padding: 4px; border-radius: 50%;
    color: #555; display: flex; align-items: center; flex-shrink: 0; transition: all 0.12s;
  }
  .cache-menu-btn:hover { background: #e0e0e0; color: #222; }
  .dark .cache-menu-btn { color: #555; }
  .dark .cache-menu-btn:hover { background: #2e2e2e; color: #bbb; }
  .cache-dropdown {
    position: absolute; right: 10px; top: calc(100% + 2px);
    background: #fff; border: 1px solid #e8e8e8; border-radius: 11px;
    box-shadow: 0 6px 24px rgba(0,0,0,0.14); min-width: 195px;
    z-index: 1000; overflow: hidden; animation: cddIn 0.12s ease;
  }
  @keyframes cddIn { from { opacity:0; transform:translateY(-5px); } to { opacity:1; transform:translateY(0); } }
  .dark .cache-dropdown { background: #242424; border-color: #3a3a3a; box-shadow: 0 6px 24px rgba(0,0,0,0.5); }
  .cache-dd-section { padding: 5px 0; border-bottom: 1px solid #f2f2f2; }
  .cache-dd-section:last-child { border-bottom: none; }
  .dark .cache-dd-section { border-color: #333; }
  .cache-dd-item {
    display: flex; align-items: center; gap: 9px;
    padding: 8px 14px; font-size: 13px; color: #333; cursor: pointer; transition: background 0.1s;
  }
  .cache-dd-item:hover { background: #f5f5f5; }
  .dark .cache-dd-item { color: #ddd; }
  .dark .cache-dd-item:hover { background: #2e2e2e; }
  .cache-dd-item .material-icons { font-size: 16px; opacity: 0.75; flex-shrink: 0; }
  .cache-dd-item.danger { color: #c62828; }
  .cache-dd-item.danger:hover { background: #fce4ec; }
  .dark .cache-dd-item.danger { color: #ef9a9a; }
  .dark .cache-dd-item.danger:hover { background: #3a1820; }
  .cache-modal-overlay {
    position: fixed; inset: 0; background: rgba(0,0,0,0.48);
    z-index: 10000; display: flex; align-items: center; justify-content: center;
    animation: cmoIn 0.15s ease;
  }
  @keyframes cmoIn { from { opacity: 0; } to { opacity: 1; } }
  .cache-modal {
    background: #fff; border-radius: 16px; padding: 24px;
    max-width: 580px; width: 92%; max-height: 82vh;
    display: flex; flex-direction: column;
    box-shadow: 0 10px 40px rgba(0,0,0,0.22); animation: cmmIn 0.15s ease;
  }
  @keyframes cmmIn { from { transform: translateY(8px); } to { transform: translateY(0); } }
  .dark .cache-modal { background: #1e1e1e; }
  .cache-modal-title { font-size: 14px; font-weight: 700; color: #333; margin-bottom: 12px; font-family: monospace; }
  .dark .cache-modal-title { color: #eee; }
  .cache-modal-body {
    flex: 1; overflow-y: auto; font-family: monospace; font-size: 12px; color: #555;
    background: #f7f7f7; border-radius: 8px; padding: 12px;
    white-space: pre-wrap; word-break: break-all; max-height: 340px;
  }
  .dark .cache-modal-body { background: #252525; color: #bbb; }
  .cache-modal-footer { display: flex; gap: 8px; margin-top: 14px; justify-content: flex-end; }
  .cache-modal-btn {
    padding: 7px 18px; border-radius: 8px; border: none; cursor: pointer;
    font-size: 13px; font-weight: 500; transition: background 0.13s; font-family: inherit;
  }
  .cache-modal-btn.primary { background: #1a73e8; color: #fff; }
  .cache-modal-btn.primary:hover { background: #1558c0; }
  .cache-modal-btn.secondary { background: #efefef; color: #333; }
  .cache-modal-btn.secondary:hover { background: #e0e0e0; }
  .dark .cache-modal-btn.secondary { background: #333; color: #ddd; }
  .dark .cache-modal-btn.secondary:hover { background: #3e3e3e; }
  .cache-empty-state { text-align: center; padding: 38px 16px; color: #bbb; font-size: 14px; }
  .cache-empty-state .material-icons { font-size: 44px; color: #ddd; display: block; margin-bottom: 8px; }
  .dark .cache-empty-state { color: #555; }
  .dark .cache-empty-state .material-icons { color: #333; }
  .cache-toast {
    position: fixed; bottom: 24px; left: 50%; transform: translateX(-50%);
    background: #222; color: #fff; padding: 8px 20px; border-radius: 22px;
    font-size: 13px; z-index: 99999; box-shadow: 0 4px 14px rgba(0,0,0,0.28);
    animation: cddIn 0.2s ease; pointer-events: none;
  }
  #cacheRawView {
    font-family: monospace; font-size: 13px; padding: 14px;
    background: #f7f7f7; border-radius: 10px; overflow-y: auto; max-height: 500px;
  }
  .dark #cacheRawView { background: #1a1a1a; }
  @container (max-width: 480px) {
    .cache-header-row { flex-direction: column; align-items: flex-start; }
  }
  </style>

  <div id="cacheViewerSection">
    <div class="cache-header-row">
      <h2 style="margin:0">Browser LocalStorage</h2>
      <div class="cache-tabs">
        <button class="cache-tab active" data-tab="param">Cache</button>
        <button class="cache-tab" data-tab="raw">Raw</button>
      </div>
    </div>
    <p style="margin-top:6px;margin-bottom:14px">The following values reside in your browser's localStorage for persistence across site visits:</p>

    <!-- Cache view (default) -->
    <div id="cacheParamView">
      <div class="cache-shortlist" id="cacheShortlist">
        <div class="cache-shortlist-title">&#9733; Short List</div>
        <div class="cache-shortlist-tags" id="cacheShortlistTags"></div>
      </div>
      <div class="cache-controls">
        <div class="cache-search-wrap">
          <span class="material-icons">search</span>
          <input type="text" class="cache-search-box" id="cacheSearch" placeholder="Search keys or values&hellip;">
        </div>
        <select class="cache-select" id="cacheFilterType" title="Filter by type">
          <option value="">All types</option>
          <option value="json">JSON</option>
          <option value="svg">SVG</option>
          <option value="string">String</option>
          <option value="number">Number</option>
          <option value="empty">Empty</option>
        </select>
        <select class="cache-select" id="cacheSortBy" title="Sort order">
          <option value="default">Default order</option>
          <option value="alpha-asc">A &#8594; Z</option>
          <option value="alpha-desc">Z &#8594; A</option>
          <option value="size-asc">Smallest first</option>
          <option value="size-desc">Largest first</option>
          <option value="pinned">Pinned first</option>
        </select>
      </div>
      <div class="cache-stats" id="cacheStats"></div>
      <div class="cache-param-list" id="cacheParamList"></div>
    </div>

    <!-- Raw view (hidden by default) -->
    <div id="cacheRawView" style="display:none">
      <div id="displayStorage"></div>
    </div>
  </div>

  <script>
  (function () {
    var shortList = [];
    var pinned = [];
    var activeDropdown = null;
    var filterGroup = '';
    var filterTagKey = '';
    try { shortList = JSON.parse(localStorage.getItem('_cacheShortList') || '[]'); } catch(e) {}
    try { pinned    = JSON.parse(localStorage.getItem('_cachePinned')    || '[]'); } catch(e) {}

    function saveState() {
      localStorage.setItem('_cacheShortList', JSON.stringify(shortList));
      localStorage.setItem('_cachePinned',    JSON.stringify(pinned));
    }

    function getType(val) {
      if (!val || val === '') return 'empty';
      if (val.indexOf('<svg') >= 0) return 'svg';
      if (!isNaN(val) && val.trim() !== '') return 'number';
      try { JSON.parse(val); return 'json'; } catch(e) {}
      return 'string';
    }

    function getItems() {
      var items = [];
      for (var i = 0; i < localStorage.length; i++) {
        var k = localStorage.key(i);
        if (k === '_cacheShortList' || k === '_cachePinned') continue;
        items.push({ key: k, value: localStorage.getItem(k) });
      }
      return items;
    }

    function trunc(s, n) {
      if (!s) return '';
      return s.length > n ? s.substring(0, n) + '\u2026' : s;
    }

    function esc(s) {
      return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
    }

    function showToast(msg) {
      var t = document.createElement('div');
      t.className = 'cache-toast';
      t.textContent = msg;
      document.body.appendChild(t);
      setTimeout(function(){ t.remove(); }, 2200);
    }

    // ---------- Short List ----------
    function renderShortList() {
      var tags = document.getElementById('cacheShortlistTags');
      var sec  = document.getElementById('cacheShortlist');
      if (!tags) return;
      tags.innerHTML = '';
      var title = sec.querySelector('.cache-shortlist-title');
      if (title) {
        title.classList.toggle('active', filterGroup === 'shortlist');
        title.onclick = function() {
          filterGroup = filterGroup === 'shortlist' ? '' : 'shortlist';
          if (filterGroup) filterTagKey = '';
          title.classList.toggle('active', filterGroup === 'shortlist');
          renderParamList();
        };
      }
      shortList.forEach(function(k) {
        var tag = document.createElement('div');
        tag.className = 'cache-shortlist-tag' + (filterTagKey === k ? ' active' : '');
        tag.innerHTML = '<span>' + esc(k) + '</span><span class="sl-remove" title="Remove">\xd7</span>';
        tag.addEventListener('click', function(e) {
          if (e.target.classList.contains('sl-remove')) {
            shortList = shortList.filter(function(x){ return x !== k; });
            if (filterTagKey === k) filterTagKey = '';
            saveState(); renderShortList(); renderParamList();
          } else {
            filterTagKey = filterTagKey === k ? '' : k;
            if (filterTagKey) filterGroup = '';
            renderShortList(); renderParamList();
          }
        });
        tags.appendChild(tag);
      });
      sec.classList.toggle('has-items', shortList.length > 0);
    }

    // ---------- Param list ----------
    function renderParamList() {
      var listEl  = document.getElementById('cacheParamList');
      var statsEl = document.getElementById('cacheStats');
      if (!listEl) return;

      var items  = getItems();
      var search = (document.getElementById('cacheSearch') || {}).value || '';
      var ftype  = (document.getElementById('cacheFilterType') || {}).value || '';
      var sort   = (document.getElementById('cacheSortBy') || {}).value || 'default';
      var total  = items.length;
      search = search.toLowerCase();

      if (search) items = items.filter(function(it){
        return it.key.toLowerCase().indexOf(search) >= 0 ||
               it.value.toLowerCase().indexOf(search) >= 0;
      });
      if (ftype) items = items.filter(function(it){ return getType(it.value) === ftype; });
      if (filterGroup === 'shortlist') items = items.filter(function(it){ return shortList.indexOf(it.key) >= 0; });
      if (filterTagKey) items = items.filter(function(it){ return it.key === filterTagKey; });

      if (sort === 'alpha-asc')  items.sort(function(a,b){ return a.key.localeCompare(b.key); });
      else if (sort === 'alpha-desc') items.sort(function(a,b){ return b.key.localeCompare(a.key); });
      else if (sort === 'size-asc')  items.sort(function(a,b){ return a.value.length - b.value.length; });
      else if (sort === 'size-desc') items.sort(function(a,b){ return b.value.length - a.value.length; });
      else if (sort === 'pinned') items.sort(function(a,b){
        return (pinned.indexOf(b.key) >= 0 ? 1 : 0) - (pinned.indexOf(a.key) >= 0 ? 1 : 0);
      });
      else items.sort(function(a,b){
        var av = (pinned.indexOf(a.key)>=0?2:(shortList.indexOf(a.key)>=0?1:0));
        var bv = (pinned.indexOf(b.key)>=0?2:(shortList.indexOf(b.key)>=0?1:0));
        return bv - av;
      });

      if (statsEl) statsEl.textContent = items.length + ' of ' + total +
        ' item' + (total !== 1 ? 's' : '') + (ftype || search ? ' (filtered)' : '');

      if (items.length === 0) {
        listEl.innerHTML = '<div class="cache-empty-state"><span class="material-icons">inventory_2</span>No items found</div>';
        return;
      }

      listEl.innerHTML = '';
      items.forEach(function(item) {
        var type   = getType(item.value);
        var isSL   = shortList.indexOf(item.key) >= 0;
        var isPin  = pinned.indexOf(item.key) >= 0;
        var disp   = type === 'svg' ? '[SVG image]' : trunc(item.value, 90);
        var el = document.createElement('div');
        el.className = 'cache-param-item' + (isPin ? ' is-pinned' : '') + (isSL ? ' in-shortlist' : '');
        el.dataset.key = item.key;
        el.innerHTML =
          '<div class="cache-param-key" title="' + esc(item.key) + '">' + esc(item.key) + '</div>' +
          '<div class="cache-param-value" title="' + (type==='svg'?'SVG image':esc(item.value)) + '">' + esc(disp) + '</div>' +
          '<span class="cache-param-type cpt-' + type + '">' + type + '</span>' +
          (isPin ? '<span class="material-icons cache-pin-icon" title="Pinned">push_pin</span>' : '') +
          '<button class="cache-menu-btn" title="More options"><span class="material-icons" style="font-size:20px">more_vert</span></button>';
        el.querySelector('.cache-menu-btn').addEventListener('click', function(e) {
          e.stopPropagation();
          openDropdown(item.key, item.value, type, isSL, isPin, el);
        });
        listEl.appendChild(el);
      });
    }

    // ---------- Dropdown ----------
    function closeDropdown() {
      if (activeDropdown) { activeDropdown.remove(); activeDropdown = null; }
    }

    function openDropdown(key, value, type, isSL, isPin, itemEl) {
      closeDropdown();
      var dd = document.createElement('div');
      dd.className = 'cache-dropdown';
      dd.innerHTML =
        '<div class="cache-dd-section">' +
          '<div class="cache-dd-item" data-act="view"><span class="material-icons">open_in_full</span>View full value</div>' +
          '<div class="cache-dd-item" data-act="copy-key"><span class="material-icons">content_copy</span>Copy key</div>' +
          '<div class="cache-dd-item" data-act="copy-val"><span class="material-icons">content_paste</span>Copy value</div>' +
        '</div>' +
        '<div class="cache-dd-section">' +
          '<div class="cache-dd-item" data-act="shortlist"><span class="material-icons">' + (isSL?'star':'star_border') + '</span>' + (isSL?'Remove from Short List':'Add to Short List') + '</div>' +
          '<div class="cache-dd-item" data-act="pin"><span class="material-icons">push_pin</span>' + (isPin?'Unpin':'Pin to top') + '</div>' +
        '</div>' +
        '<div class="cache-dd-section">' +
          '<div class="cache-dd-item" data-act="edit"><span class="material-icons">edit</span>Edit value</div>' +
          '<div class="cache-dd-item" data-act="filter-type"><span class="material-icons">filter_list</span>Filter by type: ' + type + '</div>' +
          '<div class="cache-dd-item" data-act="size"><span class="material-icons">straighten</span>Size: ' + value.length + ' chars</div>' +
        '</div>' +
        '<div class="cache-dd-section">' +
          '<div class="cache-dd-item danger" data-act="delete"><span class="material-icons">delete_outline</span>Delete item</div>' +
        '</div>';
      dd.addEventListener('click', function(e) {
        var it = e.target.closest('[data-act]');
        if (!it) return;
        closeDropdown();
        handleAction(it.dataset.act, key, value, type);
      });
      itemEl.appendChild(dd);
      activeDropdown = dd;
      setTimeout(function(){
        document.addEventListener('click', closeDropdown, { once: true });
      }, 0);
    }

    function handleAction(act, key, value, type) {
      if (act === 'view') {
        openModal(key, value, type, false);
      } else if (act === 'copy-key') {
        navigator.clipboard.writeText(key).then(function(){ showToast('Key copied!'); });
      } else if (act === 'copy-val') {
        navigator.clipboard.writeText(value).then(function(){ showToast('Value copied!'); });
      } else if (act === 'shortlist') {
        if (shortList.indexOf(key) >= 0) {
          shortList = shortList.filter(function(k){ return k !== key; });
          showToast('Removed from Short List');
        } else {
          shortList.push(key);
          showToast('Added to Short List \u2605');
        }
        saveState(); renderShortList(); renderParamList();
      } else if (act === 'pin') {
        if (pinned.indexOf(key) >= 0) {
          pinned = pinned.filter(function(k){ return k !== key; });
          showToast('Unpinned');
        } else {
          pinned.push(key);
          showToast('Pinned \ud83d\udccc');
        }
        saveState(); renderParamList();
      } else if (act === 'edit') {
        openModal(key, value, type, true);
      } else if (act === 'filter-type') {
        var sel = document.getElementById('cacheFilterType');
        if (sel) { sel.value = type; renderParamList(); }
      } else if (act === 'size') {
        showToast(key + ': ' + value.length + ' chars (' + (value.length / 1024).toFixed(2) + ' KB)');
      } else if (act === 'delete') {
        if (confirm('Delete localStorage item "' + key + '"?')) {
          localStorage.removeItem(key);
          showToast('Deleted \u2713');
          renderParamList();
        }
      }
    }

    // ---------- Modal ----------
    function openModal(key, value, type, editable) {
      var display = value;
      if (!editable && type === 'json') {
        try { display = JSON.stringify(JSON.parse(value), null, 2); } catch(e) {}
      }
      var ov = document.createElement('div');
      ov.className = 'cache-modal-overlay';
      var bodyTag = editable
        ? '<textarea class="cache-modal-body" id="cacheModalBody" style="resize:vertical;min-height:120px;font-family:monospace">' + esc(value) + '</textarea>'
        : '<div class="cache-modal-body">' + esc(display) + '</div>';
      ov.innerHTML =
        '<div class="cache-modal">' +
          '<div class="cache-modal-title">' + esc(key) + '</div>' +
          bodyTag +
          '<div class="cache-modal-footer">' +
            (!editable ? '<button class="cache-modal-btn secondary" id="cmodalCopy">Copy</button>' : '') +
            (editable  ? '<button class="cache-modal-btn secondary" id="cmodalCancel">Cancel</button>' : '') +
            (editable  ? '<button class="cache-modal-btn primary"   id="cmodalSave">Save</button>'    :
                         '<button class="cache-modal-btn primary"   id="cmodalClose">Close</button>') +
          '</div>' +
        '</div>';
      document.body.appendChild(ov);
      ov.addEventListener('click', function(e){ if (e.target === ov) ov.remove(); });
      var closeBtn = ov.querySelector('#cmodalClose');
      if (closeBtn) closeBtn.addEventListener('click', function(){ ov.remove(); });
      var cancelBtn = ov.querySelector('#cmodalCancel');
      if (cancelBtn) cancelBtn.addEventListener('click', function(){ ov.remove(); });
      var copyBtn = ov.querySelector('#cmodalCopy');
      if (copyBtn) copyBtn.addEventListener('click', function(){
        navigator.clipboard.writeText(value).then(function(){ showToast('Copied!'); });
      });
      var saveBtn = ov.querySelector('#cmodalSave');
      if (saveBtn) saveBtn.addEventListener('click', function(){
        var newVal = ov.querySelector('#cacheModalBody').value;
        localStorage.setItem(key, newVal);
        ov.remove(); showToast('Saved \u2713'); renderParamList();
      });
    }

    // ---------- Raw view ----------
    function renderRawView() {
      var el = document.getElementById('displayStorage');
      if (!el) return;
      el.innerHTML = '';
      for (var i = 0; i < localStorage.length; i++) {
        var k = localStorage.key(i);
        var v = localStorage.getItem(k);
        if (v && v.indexOf('<svg') >= 0) {
          el.innerHTML += '<b>' + esc(k) + ':</b> [svg]<br><br>';
        } else {
          el.innerHTML += '<b>' + esc(k) + ':</b> ' + esc(v) + '<br><br>';
        }
      }
    }

    // ---------- Tab / hash switching ----------
    function setView(view) {
      var pv = document.getElementById('cacheParamView');
      var rv = document.getElementById('cacheRawView');
      document.querySelectorAll('.cache-tab').forEach(function(t){
        t.classList.toggle('active', t.dataset.tab === view);
      });
      if (view === 'raw') {
        if (pv) pv.style.display = 'none';
        if (rv) rv.style.display = '';
        renderRawView();
      } else {
        if (pv) pv.style.display = '';
        if (rv) rv.style.display = 'none';
        renderParamList();
      }
    }

    // ---------- Init ----------
    function init() {
      document.querySelectorAll('.cache-tab').forEach(function(tab) {
        tab.addEventListener('click', function() {
          if (typeof goHash === 'function') {
            goHash({ cacheview: tab.dataset.tab });
          } else {
            setView(tab.dataset.tab);
          }
        });
      });

      var search = document.getElementById('cacheSearch');
      if (search) search.addEventListener('input', renderParamList);
      var ftype = document.getElementById('cacheFilterType');
      if (ftype) ftype.addEventListener('change', renderParamList);
      var fsort = document.getElementById('cacheSortBy');
      if (fsort) fsort.addEventListener('change', renderParamList);

      document.addEventListener('hashChangeEvent', function() {
        if (typeof getHash === 'function') {
          var h = getHash();
          setView(h.cacheview === 'raw' ? 'raw' : 'param');
        }
      });

      // Initial view from hash
      if (typeof getHash === 'function') {
        var h = getHash();
        setView(h.cacheview === 'raw' ? 'raw' : 'param');
      } else {
        setView('param');
      }

      renderShortList();
    }

    if (typeof waitForElm === 'function') {
      waitForElm('#cacheParamList').then(init);
    } else {
      document.addEventListener('DOMContentLoaded', init);
    }
  })();
  </script>

  <div id="cookieList" style="overflow-y: scroll;"></div>
  <script>
  function listCookies() {
      var theCookies = document.cookie.split(';');
      var aString = '';
      for (var i = 0 ; i < theCookies.length; i++) {
          console.log("theCookies[i] " + theCookies[i]);
          var theCookVal = theCookies[i].split('=');
          aString += '<b>' + theCookVal[0] + '</b> ' + theCookVal[1] + "<br>\n";
      }
      $(document).ready(function () {
        $("#cookieList").html("<h2>Cookies</h2>" + aString);
      });
  }
  if (location.host.indexOf('localhost') >= 0) {
    listCookies();
  }
  </script>

</div>

<script>
    loadMarkdown("README.md", "readmeDiv", "_parent");
    loadMarkdown("start/features.md", "featuresDiv", "_parent");
    loadMarkdown("start/params.md", "paramsDiv", "_parent");
</script>

<img loading="lazy" fetchpriority="low" src="/localsite/img/hero/stars.jpg" style="width:100%">

<div id="footer"></div>

</body>
</html>



